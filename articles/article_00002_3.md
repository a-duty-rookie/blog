---
title: "ä¸€è‡´æ€§ã¨ä¸åæ€§â‘¢"
emoji: "ğŸ·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [çµ±è¨ˆ,python]
published: true
published_at: 2024-05-03 19:00
---

## 3è¡Œã¾ã¨ã‚

1. ä¸€è‡´æ€§ã¨ä¸åæ€§ã‚’å®Ÿéš›ã«è©¦ã—ã¦ã¿ã¾ã—ãŸ
2. æ­£è¦åˆ†å¸ƒã€ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã€äºŒé …åˆ†å¸ƒã€æŒ‡æ•°åˆ†å¸ƒã€ä¸€æ§˜åˆ†å¸ƒ
3. ã‚„ã£ã±ã‚Šã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦çµæœãŒå‡ºã¦ãã‚‹ã®ã¯æ¥½ã—ã„ã­ã€‚

## å‚è€ƒæ›¸ç±

å…¥é–€è©æ¬ºã¨ã—ã¦æœ‰åãª[çµ±è¨ˆå­¦å…¥é–€](https://amzn.to/4dmDECE)ã‚’ä½¿ã£ã¦å‹‰å¼·ã—ã¦ã„ã¾ã™ã€‚
https://amzn.to/4dmDECE

:::message
**å…è²¬äº‹é …**
é–“é•ã„ã®ãªã„ã‚ˆã†ã«ç†è§£ã—ãŸã„ã¨ã„ã†æ€ã„ã§å­¦ç¿’ã‚’ã—ã¦ã„ã¾ã™ãŒã€ãªã«ã¶ã‚“ç‹¬å­¦ã§ã‚ã‚Šã€å°‚é–€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã®ã§ã€ã‚ãã¾ã§ã‚‚ç§ã¯ã“ã†è§£é‡ˆã—ãŸã€ã¨ã„ã†å†…å®¹ã§ã‚ã‚‹ã“ã¨ã”äº†æ‰¿ãã ã•ã„ã€‚
æœ¬æ–‡ã«ãŠã„ã¦æ–­å®šèª¿ã§è¨˜è¼‰ã—ã¦ã„ã‚‹éƒ¨åˆ†ã‚‚ã‚ã‚Šã¾ã™ãŒã€ã„ã¡ã„ã¡ã€Œã€œã¨ç§ã¯ç†è§£ã—ã¦ã„ã¾ã™ã€ã¨è¨˜è¼‰ã™ã‚‹ã¨å†—é•·ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€ä½“è£ä¸Šã€Œã€œã§ã™ã€ã¨è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚
æ±ºå®šçš„ãªèª¤ã‚Šã‚„ã€å±é™ºãªè§£é‡ˆã‚’ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚ŒãŸå ´åˆã¯å¿Œæ†šãªãã”æŒ‡æ‘˜ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚
:::

## å‰å›ã®ã‚ã‚‰ã™ã˜

https://zenn.dev/a_duty_rookie/articles/article_00002_2

:::details å‰å›ã®3è¡Œè¦ç´„

1. ã‚ˆãå•ã‚ã‚Œã‚‹æ¨™æœ¬åˆ†æ•£ã®ä¸åæ€§ã¯æ¯åˆ†æ•£ã¨å¹³å‡ã®åˆ†æ•£ã®å½¢ã«ã†ã¾ãæŒã£ã¦ã„ãã¨è¨¼æ˜ã§ãã‚‹
2. ä¸€è‡´æ€§ã¯ã‚·ã‚§ãƒ“ãƒã‚§ãƒ•ã®ä¸ç­‰å¼ã«æŒã£ã¦ã„ã£ã¦ã€$n \to \infty$ã®æ™‚ã®æœŸå¾…å€¤ã¨åˆ†æ•£ã«ç€ç›®
3. ã‚·ã‚§ãƒ“ãƒã‚§ãƒ•ã®ä¸ç­‰å¼ã¯ã™ã”ã„

:::

ä»Šå›ã¯ã€ä¸€è‡´æ€§ã¨ä¸åæ€§ã®ç· ã‚ããã‚Šã¨ã—ã¦ã€æ¯å¹³å‡ã¨æ¯åˆ†æ•£ã‚’è¨­å®šã—ãŸä¸Šã§å®Ÿéš›ã«pythonã§ä¹±æ•°ã‚’ç™ºç”Ÿã•ã›ã¦éŠã‚“ã§ã¿ã¾ã—ãŸã€‚

## å®Ÿé¨“ã®æ¦‚è¦

ã“ã“ã¾ã§ã®è­°è«–ã§ã¯æ¯é›†å›£åˆ†å¸ƒã®ç¨®é¡ã‚’é™å®šã—ã¦ãŠã‚‰ãšã€æ¨™æœ¬å¹³å‡ã¨ä¸ååˆ†æ•£ã®ä¸€è‡´æ€§ã€ä¸åæ€§ã®è¨¼æ˜ã§ã‚‚ã€ç‰¹ã«æ¯é›†å›£åˆ†å¸ƒãŒã€‡ã€‡ã§ã‚ã‚‹ã€ã¨ã„ã†ä»®å®šã¯ã—ã„ã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚
ãã“ã§ã€ä»Šå›ã®å®Ÿé¨“ã§ã¯ä»¥ä¸‹ã®3ã¤ã®æ¯é›†å›£ã‚’æº–å‚™ã—ã¾ã™ã€‚

- æ­£è¦åˆ†å¸ƒã«å¾“ã†æ¯é›†å›£
- ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†æ¯é›†å›£
- ã‚¬ãƒ³ãƒåˆ†å¸ƒã¨ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«çµ„ã¿åˆã‚ã›ã¦ä½œæˆã—ãŸãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªæ¯é›†å›£

ãã‚Œãã‚Œã®åˆ†å¸ƒã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®ï¼“ã‚¹ãƒ†ãƒƒãƒ—ã§å®Ÿé¨“ã‚’è¡Œãªã£ã¦ã„ãã¾ã™ã€‚

1. æ¯é›†å›£åˆ†å¸ƒã®å¯è¦–åŒ–  
2. ä¸€è‡´æ€§ã®ç¢ºèª  
ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’10~10,000ã§10åˆ»ã¿ã«å¢—åŠ ã•ã›ã¦ã„ãã€ãã‚Œãã‚Œã®ã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰æ¨å®šé‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãããªã£ãŸã¨ãã€æ¨å®šé‡ã¯æœãŸã—ã¦æ¯æ•°ã«ä¸€è‡´ã™ã‚‹ã‹ï¼Ÿã¨ã„ã†ã“ã¨ã‚’ç¢ºã‹ã‚ã¾ã™ã€‚
3. ä¸åæ€§ã®ç¢ºèª  
ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯ä¸€å®š(50ã¨ã—ã¾ã—ãŸ)ã¨ã—ã¦ã€ãã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°è¡Œç‚ºè‡ªä½“ã‚’å¢—ã‚„ã—ã¦ã„ãã¾ã™(1~10,000å›ã¨ã—ã¾ã—ãŸ)ã€‚
æ¨å®šé‡ãŒã©ã‚“ã©ã‚“å¾—ã‚‰ã‚Œã¦ã„ãã«ã¤ã‚Œã¦ã€ãã‚Œã‚‰ã®å¹³å‡å€¤ã¯æœãŸã—ã¦æ¯æ•°ã«ä¸€è‡´ã™ã‚‹ã‹ï¼Ÿã¨ã„ã†ã“ã¨ã‚’ç¢ºã‹ã‚ã¾ã™ã€‚

ãªãŠã€ä»Šå›ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ã™ã‚‹æ¨å®šé‡ã¯ã€æ¨™æœ¬å¹³å‡ã€æ¨™æœ¬åˆ†æ•£ã€ä¸ååˆ†æ•£ã®3ã¤ã¨ã—ã¾ã™ã€‚

:::details ã‚³ãƒ¼ãƒ‰ã«é–¢ã—ã¦
ä»¥ä¸‹ã€å®Ÿé¨“ã‚„è£½å›³ã«ä½¿ç”¨ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ãƒˆã‚°ãƒ«ã«ã¦è¨˜è¿°ã—ã¾ã™ã€‚
python3.10.11ã§jupyter notebookä¸Šã§å®Ÿæ–½ã—ã¦ã„ã¾ã™ãŒã€å¤§ã—ãŸã‚³ãƒ¼ãƒ‰ã§ã¯ãªã„ã®ã§ç´°ã‹ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯å‰²æ„›ã—ã¾ã™ã€‚
ã¾ãŸã€ã™ã¹ã¦å†’é ­ã§ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã“ã¨ãŒå‰æã§è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

``` python
import numpy as np
import scipy.stats as st
import matplotlib.pyplot as plt
import os
import japanize_matplotlib.japanize_matplotlib

SEED = 42
SAVE_DIR = 'ä»»æ„ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª'
```

:::

## çµæœ

### æ­£è¦åˆ†å¸ƒã«å¾“ã†æ¯é›†å›£

#### æ¯é›†å›£åˆ†å¸ƒ

![æ­£è¦æ¯é›†å›£ã®å¯è¦–åŒ–](/images/articles/article_00002_3/normal.png)

:::details ã‚³ãƒ¼ãƒ‰

``` py
mu = 60 # æ¯å¹³å‡ã®è¨­å®š
sigma_2 = 10**2 # æ¯åˆ†æ•£ã®è¨­å®š
np.random.seed(SEED)
sample = np.random.normal(
 loc=mu,
 scale=np.sqrt(sigma_2),
 size=10000,
 )

plt.figure(figsize=(5,3))

plt.hist(
 sample,
 density=True,
 label='samples_hist',
 )

p = st.norm.pdf(
 x=np.arange(1,101,1),
 loc = mu,
 scale =np.sqrt(sigma_2),
)
plt.plot(p,label='pdf')
plt.legend(loc='best')
plt.xlabel('ç¢ºç‡å¤‰æ•°')
plt.ylabel('ç¢ºç‡å¯†åº¦')
plt.title(f'æ¯å¹³å‡{mu},æ¯åˆ†æ•£{sigma_2}ã®æ­£è¦æ¯é›†å›£')
plt.savefig(f'{SAVE_DIR}/æ­£è¦æ¯é›†å›£.png',bbox_inches='tight')
plt.show()
```

:::

å®Ÿè·µã¯å¯†åº¦é–¢æ•°ã‚’ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¯10,000å€‹ç™ºç”Ÿã•ã›ãŸä¹±æ•°ã®åˆ†å¸ƒã‚’ç¤ºã—ã¦ã„ã¾ã™ãŒã€ç¶ºéº—ãªãƒ™ãƒ«ã‚«ãƒ¼ãƒ–ãŒè¦‹ã‚Œã¾ã™ã­ã€‚

#### ä¸€è‡´æ€§ã®ç¢ºèª

![ä¸€è‡´æ€§ã®ç¢ºèª](/images/articles/article_00002_3/normal_consistency.png)

:::details ã‚³ãƒ¼ãƒ‰

``` py
mu = 60 # æ¯å¹³å‡ã®è¨­å®š
sigma_2 = 10**2 # æ¯åˆ†æ•£ã®è¨­å®š
np.random.seed(SEED)

# ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯10~10,000ã‚’10åˆ»ã¿
sample_size = np.arange(10,10001,10)

x_bar = np.zeros(len(sample_size))
S_2 = np.zeros(len(sample_size))
s_2 = np.zeros(len(sample_size))

for size in sample_size:
 sample = np.random.normal(
  loc=mu,
  scale=np.sqrt(sigma_2),
  size=size,
  )
 x_bar[sample_size==size]=np.mean(sample)
 S_2[sample_size==size]=np.var(sample,ddof=0)
 s_2[sample_size==size]=np.var(sample,ddof=1)
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 [x_bar,S_2,s_2],
 [mu,sigma_2,sigma_2],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  sample_size,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=np.max(sample_size),
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º')
 ax.set_ylabel(title)
fig.suptitle('ä¸€è‡´æ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/æ­£è¦æ¯é›†å›£_ä¸€è‡´æ€§.png',bbox_inches='tight')
plt.show()
```

:::

è¨¼æ˜é€šã‚Š[^1]ã€3ã¤ã®æ¨å®šé‡ã¯ã™ã¹ã¦ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’æ¥µå¤§ã«ã—ãŸã¨ãã«æ¯æ•°ã«åæŸã—ãã†ãªé›°å›²æ°—ãŒæ„Ÿã˜ã‚‰ã‚Œã¾ã™ã€‚

[^1]:å³å¯†ã«ã„ã†ã¨æ¨™æœ¬åˆ†æ•£ã€ä¸ååˆ†æ•£ã®ä¸€è‡´æ€§ã®è¨¼æ˜ã¯ã‚µãƒœã‚Šã¾ã—ãŸã€‚

#### ä¸åæ€§ã®ç¢ºèª

![ä¸åæ€§](/images/articles/article_00002_3/normal_unbiasedness.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
mu = 60 # æ¯å¹³å‡ã®è¨­å®š
sigma_2 = 10**2 # æ¯åˆ†æ•£ã®è¨­å®š
sample_size = 50 # ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯100
trial = 10000 # è©¦è¡Œå›æ•°ã‚’3000å›
np.random.seed(SEED)

# å„è©¦è¡Œã§å¾—ã‚‰ã‚Œã‚‹æ¨å®šé‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
x_bar = []
S_2 = []
s_2 = []

# å„è©¦è¡Œçµ‚äº†æ™‚ã®æ¨å®šé‡ã®å¹³å‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
mean_x_bar = []
mean_S_2 = []
mean_s_2 = []

for i in range(trial):
 sample = np.random.normal(
  loc=mu,
  scale=np.sqrt(sigma_2),
  size=sample_size
  )
 x_bar.append(np.mean(sample))
 mean_x_bar.append(np.mean(x_bar))
 S_2.append(np.var(sample,ddof=0))
 mean_S_2.append(np.mean(S_2))
 s_2.append(np.var(sample,ddof=1))
 mean_s_2.append(np.mean(s_2))
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 # [x_bar,S_2,s_2],
 [mean_x_bar,mean_S_2,mean_s_2],
 [mu,sigma_2,sigma_2],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  np.arange(trial)+1,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=trial,
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('è©¦è¡Œå›æ•°')
 ax.set_ylabel(f'{title}ã®å¹³å‡')
fig.suptitle('ä¸åæ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/æ­£è¦æ¯é›†å›£_ä¸åæ€§.png',bbox_inches='tight')
plt.show()
```

:::

ã€ŒãŠã‰ï¼ã‚„ã£ã±ã‚Šæ¨™æœ¬åˆ†æ•£ã¯ã‚¢ã‚«ãƒ³ã®ã‚„ï¼ã€
ã¨ãªã‚‹çµæœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã­ã€‚
è¨¼æ˜é€šã‚Šæ¨™æœ¬åˆ†æ•£ã¯ã€çœŸã®åˆ†æ•£ã¨æ¯”ã¹ã¦ä½ãè¦‹ç©ã‚‚ã‚‰ã‚ŒãŒã¡ã€ã¨ã„ã†ã¨ã“ã‚ãŒå¦‚å®Ÿã«ç¾ã‚Œã¦ã„ã¾ã™ã€‚

### ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†æ¯é›†å›£

ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã¯ã€ä»¥ä¸‹ã®ç¢ºç‡è³ªé‡é–¢æ•°ã§è¡¨ã•ã‚Œã‚‹é›¢æ•£ç¢ºç‡åˆ†å¸ƒã§ã‚ã‚Šã€ç¢ºç‡å¤‰æ•°ãŒæ­£ã®æ•´æ•°ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã‚‹ãŸã‚ã€å›æ•°ã¨ã‹å€‹æ•°ã¿ãŸã„ãªäº‹æŸ„ã«é–¢é€£ã™ã‚‹ç¢ºç‡ã‚’è€ƒãˆã‚‹éš›ã«æ¡ç”¨ã•ã‚ŒãŒã¡[^2]ã§ã™ã€‚

$$
P(X=x)=\frac{\lambda^x}{x!}e^{-\lambda} \quad \footnotesize x=\{0,1,2,3,\dots\}
$$

ã“ã®åˆ†å¸ƒã¯å¹³å‡ã¨åˆ†æ•£ãŒã©ã¡ã‚‰ã‚‚$\lambda$ã«ãªã‚Š[^3]ã€ã“ã‚Œã«å¯¾ã™ã‚‹æ¨å®šé‡ã®ä¸€è‡´æ€§ã¨ä¸åæ€§ã‚’ç¢ºã‹ã‚ã¦ã„ãã¾ã™ã€‚
ã‚µã‚¯ãƒƒã¨ã„ãã¾ã™ã€‚

[^2]:å®Ÿéš›ã®ã¨ã“ã‚ã¯ã€å˜ä½æ™‚é–“ã‚ãŸã‚Šã«å¹³å‡$\lambda$å›ç™ºç”Ÿã™ã‚‹äº‹è±¡ãŒã€æ¬¡ã®å˜ä½æ™‚é–“å†…ã«ç™ºç”Ÿã™ã‚‹å›æ•°XãŒå¾“ã†ç¢ºç‡åˆ†å¸ƒã€ã§ã™ã€‚
[^3]:ãªã®ã§ã€æ¨™æœ¬å¹³å‡ã¨ä¸ååˆ†æ•£ãŒå¤§ä½“åŒã˜ãã‚‰ã„ã«ãªã£ã¦ãªã„ã¨ã€ã»ã‚“ã¨ã«ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã‚‚è‰¯ã„ã®ã‹ï¼Ÿã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã­ã€‚

#### æ¯é›†å›£åˆ†å¸ƒ

![ãƒãƒ¯ã‚½ãƒ³åˆ†å¸ƒ](/images/articles/article_00002_3/poisson.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
lam = 50 # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
np.random.seed(SEED)
sample = np.random.poisson(
 lam=lam,
 size=10000,
 )

plt.figure(figsize=(5,3))

plt.hist(
 sample,
 density=True,
 label='samples_hist',
 )

p = st.poisson.pmf(
 k=np.arange(1,101,1),
 mu=lam
)
plt.plot(p,label='pmf')
plt.legend(loc='best')
plt.xlabel('ç¢ºç‡å¤‰æ•°')
plt.ylabel('ç¢ºç‡å¯†åº¦')
plt.title(f'æ¯å¹³å‡{lam},æ¯åˆ†æ•£{lam}ã®ãƒãƒ¯ã‚½ãƒ³æ¯é›†å›£')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ¯ã‚½ãƒ³æ¯é›†å›£.png',bbox_inches='tight')
plt.show()
```

:::

#### ä¸€è‡´æ€§ã®ç¢ºèª

![ä¸€è‡´æ€§](/images/articles/article_00002_3/poisson_consistency.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
np.random.seed(SEED)

# ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯10~10,000ã‚’10åˆ»ã¿
sample_size = np.arange(10,10001,10)

x_bar = np.zeros(len(sample_size))
S_2 = np.zeros(len(sample_size))
s_2 = np.zeros(len(sample_size))

for size in sample_size:
 sample = np.random.poisson(
  lam=lam,
  size=size,
  )
 x_bar[sample_size==size]=np.mean(sample)
 S_2[sample_size==size]=np.var(sample,ddof=0)
 s_2[sample_size==size]=np.var(sample,ddof=1)
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 [x_bar,S_2,s_2],
 [lam,lam,lam],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  sample_size,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=np.max(sample_size),
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º')
 ax.set_ylabel(title)
fig.suptitle('ä¸€è‡´æ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ¯ã‚½ãƒ³æ¯é›†å›£_ä¸€è‡´æ€§.png',bbox_inches='tight')
plt.show()
```

:::

#### ä¸åæ€§ã®ç¢ºèª

![ä¸åæ€§](/images/articles/article_00002_3/poisson_unbiasedness.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
sample_size = 50 # ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯100
trial = 10000 # è©¦è¡Œå›æ•°ã‚’3000å›
np.random.seed(SEED)

# å„è©¦è¡Œã§å¾—ã‚‰ã‚Œã‚‹æ¨å®šé‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
x_bar = []
S_2 = []
s_2 = []

# å„è©¦è¡Œçµ‚äº†æ™‚ã®æ¨å®šé‡ã®å¹³å‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
mean_x_bar = []
mean_S_2 = []
mean_s_2 = []

for i in range(trial):
 sample = np.random.poisson(
  lam=lam,
  size=sample_size,
  )
 x_bar.append(np.mean(sample))
 mean_x_bar.append(np.mean(x_bar))
 S_2.append(np.var(sample,ddof=0))
 mean_S_2.append(np.mean(S_2))
 s_2.append(np.var(sample,ddof=1))
 mean_s_2.append(np.mean(s_2))
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 # [x_bar,S_2,s_2],
 [mean_x_bar,mean_S_2,mean_s_2],
 [lam,lam,lam],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  np.arange(trial)+1,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=trial,
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('è©¦è¡Œå›æ•°')
 ax.set_ylabel(f'{title}ã®å¹³å‡')
fig.suptitle('ä¸åæ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ¯ã‚½ãƒ³æ¯é›†å›£_ä¸åæ€§.png',bbox_inches='tight')
plt.show()
```

:::

ãªã‚“ã¹ã‚“ã‚„ã£ã¦ã‚‚ã€æ¨™æœ¬åˆ†æ•£ã«ä¸åæ€§ãŒãªã„ã“ã¨ãŒãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã¨ã—ã¦å‡ºã¦ãã‚‹ç¬é–“ã¯ã‚­ãƒ¢ãƒ†ã‚£ã‚¤ã‚£ã‚¤ã‚¤ã‚£ã‚£ã‚¤ã‚¤ã‚£ï¼ï¼ï¼

### ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯

ä¾‹ãˆã°äºŒå³°æ€§ãŒã‚ã£ãŸã‚Šã€æ˜ã‚‰ã‹ã«è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªåˆ†å¸ƒãŒé‡è¤‡ã—ã¦åŠ¹ã„ã¦ã„ãã†ãªã”ã¡ã‚ƒã£ã¨ã—ãŸåˆ†å¸ƒã«å¯¾ã—ã¦ã‚‚æˆã‚Šç«‹ã¤ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ã¨ã„ã†ã“ã¨ã§ã€ä½œã£ãŸæœ¬äººã§ã•ãˆã‚‚ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã«å†ç¾ã™ã‚‹ã“ã¨ãŒã§ããªã„åˆ†å¸ƒã¨ã—ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æŒ‡å®šã—ãŸã‚¬ãƒ³ãƒåˆ†å¸ƒorãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã‚’100å€‹ç”¨æ„ã—ã¦ã€ãã“ã‹ã‚‰1,000å€‹ãšã¤ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦å¾—ã‚‰ã‚ŒãŸ100,000å€‹ã®æ•°å€¤ã‚’æ¯é›†å›£ã¨ã—ãŸå®Ÿé¨“ã‚’ã—ã¦ã¿ã¾ã—ãŸã€‚

#### æ¯é›†å›£åˆ†å¸ƒ

![ãƒãƒ³ãƒ‘ãƒ©](/images/articles/article_00002_3/nonparametric.png)

ãªã‚“ã ã‹ã†ã¾ãã„ã£ã¦ãªã„æ™‚ã®MCMCã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°çµæœã¿ãŸã„ãªã€ã„ã„æ„Ÿã˜ã®åˆ†å¸ƒãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã‚ˆã€‚

:::details ã‚³ãƒ¼ãƒ‰

```py
# ä¹±æ•°ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
rvg = np.random.default_rng()

np.random.seed(SEED)

# ã‚¬ãƒ³ãƒåˆ†å¸ƒãŒãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã‹ã®ã©ã¡ã‚‰ã‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã³ã€
# ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºã‚ã‚‰ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦1,000å€‹ã®ä¹±æ•°ã‚’å–å¾—ã€
# ã¨ã„ã†æ“ä½œã‚’100å›ç¹°ã‚Šè¿”ã—ã¦ã€ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãª100,000å€‹ã®
# æ•°å€¤ã‹ã‚‰ãªã‚‹æ¯é›†å›£ã‚’ä½œæˆã™ã‚‹ã€‚

kinds = [
    rvg.gamma,
    rvg.beta
    ]
each_size = 1000
iter = 100
population=[]

for i in range(iter):
 arg1,arg2 = np.random.rand(2)
 gen = np.random.choice(kinds)
 samples = gen(arg1,arg2,each_size)
 population.append(samples)
population = np.array(population).ravel()

fig,axes = plt.subplots(
 1,2,
 figsize=(7,3.5),
 tight_layout=True,
 sharey=True
)

axes[0].plot(population)
axes[0].set_xlabel('sample #')
axes[0].set_ylabel('Value')
axes[0].set_title('chain')

binwidth = .1
bins=np.arange(np.min(population),np.max(population)+1,binwidth)
axes[1].hist(population,bins=bins,orientation='horizontal')
axes[1].set_xlabel('Freq')
axes[1].set_title(f'hist binsize={binwidth:.2f}')

mu = np.mean(population)
sigma_2 = np.var(population,ddof=0)

for ax in axes:
 xmin,xmax = ax.get_xlim()
 ax.hlines(xmin=xmin,xmax=xmax,y=mu,colors='red',alpha=.5)
 ax.fill_between(
  x=np.linspace(xmin,xmax,1000),
  y1=mu-np.sqrt(sigma_2),
  y2=mu+np.sqrt(sigma_2),
  facecolor='gray',
  alpha=.5
  )

fig.suptitle(f'è¬ã®æ¯é›†å›£åˆ†å¸ƒ æ¯å¹³å‡={mu:.2f},æ¯åˆ†æ•£={sigma_2:.2f},è¦ç´ æ•°={len(population):,}')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ³ãƒ‘ãƒ©æ¯é›†å›£.png',bbox_inches='tight')
plt.show()
```

:::

#### ä¸€è‡´æ€§ã®ç¢ºèª

![ä¸€è‡´æ€§](/images/articles/article_00002_3/nonparametric_consistency.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
np.random.seed(SEED)

# ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯10~10,000ã‚’10åˆ»ã¿
sample_size = np.arange(10,10001,10)

x_bar = np.zeros(len(sample_size))
S_2 = np.zeros(len(sample_size))
s_2 = np.zeros(len(sample_size))

for size in sample_size:
 sample = np.random.choice(
  population,
  size=size,
  )
 x_bar[sample_size==size]=np.mean(sample)
 S_2[sample_size==size]=np.var(sample,ddof=0)
 s_2[sample_size==size]=np.var(sample,ddof=1)
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 [x_bar,S_2,s_2],
 [mu,sigma_2,sigma_2],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  sample_size,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=np.max(sample_size),
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º')
 ax.set_ylabel(title)
fig.suptitle('ä¸€è‡´æ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ³ãƒ‘ãƒ©æ¯é›†å›£_ä¸€è‡´æ€§.png',bbox_inches='tight')
plt.show()
```

:::

å˜å³°æ€§ã¨æ¯”ã¹ã‚‹ã¨ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°çµæœã®ã°ã‚‰ã¤ããŒå¤§ãã„ã®ã§ã€åæŸã™ã‚‹ã¾ã§ã«å¿…è¦ãªã‚µãƒ³ãƒ—ãƒ«æ•°ã¯å¢—ãˆã‚‹å‚¾å‘ã«ã‚ã‚Šã¾ã™ãŒã€ãªã‚“ã¨ãªãæ¯æ•°ã«åæŸã—ãã†ãªæ„Ÿã˜ã§ã™ã€‚

#### ä¸åæ€§ã®ç¢ºèª

![ä¸åæ€§](/images/articles/article_00002_3/nonparametric_unbiasedness.png)

:::details ã‚³ãƒ¼ãƒ‰

```py
sample_size = 50 # ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯100
trial = 10000 # è©¦è¡Œå›æ•°ã‚’3000å›
np.random.seed(SEED)

# å„è©¦è¡Œã§å¾—ã‚‰ã‚Œã‚‹æ¨å®šé‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
x_bar = []
S_2 = []
s_2 = []

# å„è©¦è¡Œçµ‚äº†æ™‚ã®æ¨å®šé‡ã®å¹³å‡ã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
mean_x_bar = []
mean_S_2 = []
mean_s_2 = []

for i in range(trial):
 sample = np.random.choice(
  population,
  size=sample_size
  )
 x_bar.append(np.mean(sample))
 mean_x_bar.append(np.mean(x_bar))
 S_2.append(np.var(sample,ddof=0))
 mean_S_2.append(np.mean(S_2))
 s_2.append(np.var(sample,ddof=1))
 mean_s_2.append(np.mean(s_2))
fig, axes = plt.subplots(
 ncols=3,
 nrows=1,
 figsize=(10,3),
 tight_layout=True,
)

for ax,score,answer,title in zip(
 axes,
 # [x_bar,S_2,s_2],
 [mean_x_bar,mean_S_2,mean_s_2],
 [mu,sigma_2,sigma_2],
 ['æ¨™æœ¬å¹³å‡','æ¨™æœ¬åˆ†æ•£','ä¸ååˆ†æ•£']
 ):
 ax.plot(
  np.arange(trial)+1,
  score,
  alpha=.5,
 )
 ax.hlines(
  xmin=0,
  xmax=trial,
  y=answer,
  alpha=0.5,
  colors='r',
 )
 ax.set_xlabel('è©¦è¡Œå›æ•°')
 ax.set_ylabel(f'{title}ã®å¹³å‡')
fig.suptitle('ä¸åæ€§ã®æ¤œè¨¼')
plt.savefig(f'{SAVE_DIR}/ãƒãƒ³ãƒ‘ãƒ©æ¯é›†å›£_ä¸åæ€§.png',bbox_inches='tight')
plt.show()
```

:::

ãƒ³ã‚®ãƒ¢ãƒ†ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚£ã‚¤ã‚¤ã‚¤ã‚£ã‚¤ï¼ï¼ï¼ï¼
ã“ã¡ã‚‰ã‚‚ã‚„ã¯ã‚Šå˜å³°æ€§ã¨æ¯”ã¹ã‚‹ã¨ã€ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°çµæœã®ã°ã‚‰ã¤ããŒå¤§ãã„ã®ã§ã€åæŸã™ã‚‹ã¾ã§ã«å¿…è¦ãªè©¦è¡Œæ•°ã¯å¢—ãˆã‚‹å‚¾å‘ã«ã‚ã‚Šã¾ã™ãŒã€ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã§ã‚‚ã—ã£ã‹ã‚Šã¨ä¸ååˆ†æ•£ã«ä¸åæ€§ãŒã‚ã‚‹ã“ã¨ãŒç¢ºã‹ã‚ã‚Œã‚‰ã¾ã—ãŸã­ï¼

## çµ‚ã‚ã‚Šã«

ã‚„ã£ã±ã‚Šã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã€æƒ³å®šã•ã‚ŒãŸçµæœãŒç¶ºéº—ã«å›³ç¤ºã•ã‚ŒãŸç¬é–“ã€ãŸã¾ã‚‰ãªã„ã§ã™ã­ï¼
ã†ã£ã‹ã‚Š3å›ã«è·¨ã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒã€ä¸åæ€§ã€ä¸€è‡´æ€§ã«ã¤ã„ã¦ç†è§£ãŒã‚ã‚‹ç¨‹åº¦å®šç€ã—ãŸã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚
å˜ç´”ã«ã“ã“ã®å˜å…ƒã ã‘èª­ã‚“ã§ã„ã¦ã‚‚ã€ãµã‚“ãµã‚“ã¨ã‚ã‹ã£ãŸæ°—ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã™ãŒã€æœ€å°äºŒä¹—æ¨å®šé‡ãŒBLUEã§ã‚ã‚‹ã“ã¨ã€ã¿ãŸã„ãªã¨ã“ã‚ã§çªç„¶å‡ºã¦ãã¦ã€ã‚ã‚Œã‚ã‚Œã€œã¨ãªã£ã¦ã—ã¾ã„ãŒã¡ã€‚
æ¬¡ã¯æœ€å°äºŒä¹—æ³•ã«ã¤ã„ã¦ã‚‚ãã¡ã‚“ã¨å¾©ç¿’ã—ãŸã„ãªã‚ã¨ã„ã†æ‰€å­˜ã§ã™ã€‚

ä»¥ä¸Šã€ã”ç¢ºèªã®ã»ã©ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚
